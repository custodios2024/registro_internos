<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Internos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.13/jspdf.plugin.autotable.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; }
        h2 { text-align: center; }
        h3 { text-align: center; }
        label { font-weight: bold; display: block; margin-top: 10px; }
        input { width: 100%; padding: 8px; margin-bottom: 10px; }
        button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; cursor: pointer; margin-top: 10px; }
        button:hover { background: #0056b3; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background: #007bff; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <img src="logo_sspc2.png" alt="Logo SSPC" style="display: block; margin: auto; width: 100px;">
        <h2>Registro de Internos</h2>
        <form id="registroForm">
            <label>Fecha: <input type="date" id="fecha" required></label>
            <label>Hora: <input type="time" id="hora" required></label>
            <label>Motivo: <input type="text" id="motivo" required></label>
            <label>Excarcelados (H): <input type="number" id="excarceladosH" required></label>
            <label>Excarcelados (M): <input type="number" id="excarceladosM" required></label>
            <label>Presentes (H): <input type="number" id="presentesH" required></label>
            <label>Presentes (M): <input type="number" id="presentesM" required></label>
            <label>Total: <input type="number" id="total" required readonly></label>
            <label>Custodio Responsable: <input type="text" id="custodioResponsable" required></label>
            <label>Personal DGRS: <input type="text" id="personalDGRS" required></label>
            <button type="button" onclick="guardarRegistro()">Guardar</button>
            <button type="button" onclick="exportarPDF()">Exportar a PDF</button>
        </form>
        <table id="tablaRegistros">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Hora</th>
                    <th>Motivo</th>
                    <th>Excarc. (H)</th>
                    <th>Excarc. (M)</th>
                    <th>Pres. (H)</th>
                    <th>Pres. (M)</th>
                    <th>Total</th>
                    <th>Custodio</th>
                    <th>Personal DGRS</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <script>
        function guardarRegistro() {
            const registro = {
                fecha: document.getElementById('fecha').value,
                hora: document.getElementById('hora').value,
                motivo: document.getElementById('motivo').value,
                excarceladosH: document.getElementById('excarceladosH').value,
                excarceladosM: document.getElementById('excarceladosM').value,
                presentesH: document.getElementById('presentesH').value,
                presentesM: document.getElementById('presentesM').value,
                total: document.getElementById('total').value,
                custodioResponsable: document.getElementById('custodioResponsable').value,
                personalDGRS: document.getElementById('personalDGRS').value
            };
            
            let registros = JSON.parse(localStorage.getItem('registros')) || [];
            registros.push(registro);
            localStorage.setItem('registros', JSON.stringify(registros));
            mostrarRegistros();
        }
        
        function mostrarRegistros() {
            let registros = JSON.parse(localStorage.getItem('registros')) || [];
            let tbody = document.querySelector('#tablaRegistros tbody');
            tbody.innerHTML = '';
            registros.forEach(registro => {
                let fila = `<tr>
                    <td>${registro.fecha}</td>
                    <td>${registro.hora}</td>
                    <td>${registro.motivo}</td>
                    <td>${registro.excarceladosH}</td>
                    <td>${registro.excarceladosM}</td>
                    <td>${registro.presentesH}</td>
                    <td>${registro.presentesM}</td>
                    <td>${registro.total}</td>
                    <td>${registro.custodioResponsable}</td>
                    <td>${registro.personalDGRS}</td>
                </tr>`;
                tbody.innerHTML += fila;
            });
        }
        
        function exportarPDF() {
            const doc = new jsPDF();
            doc.text('Registro de Internos', 105, 20, null, null, 'center');
            doc.addImage('logo_sspc2.png', 'PNG', 10, 10, 30, 30);
            
            let registros = JSON.parse(localStorage.getItem('registros')) || [];
            const headers = ['Fecha', 'Hora', 'Motivo', 'Excarc. (H)', 'Excarc. (M)', 'Pres. (H)', 'Pres. (M)', 'Total', 'Custodio', 'Personal DGRS'];
            const data = registros.map(r => [
                r.fecha, r.hora, r.motivo, r.excarceladosH, r.excarceladosM,
                r.presentesH, r.presentesM, r.total, r.custodioResponsable, r.personalDGRS
            ]);
            
            doc.autoTable({ head: [headers], body: data, startY: 40 });
            doc.save('registro_internos.pdf');
        }
        
        document.addEventListener('DOMContentLoaded', mostrarRegistros);
    </script>
</body>
</html>
