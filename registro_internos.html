<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Internos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.8/jspdf.plugin.autotable.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 500px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
        }
        h2 {
            text-align: center;
            margin-top: 60px;
        }
        label {
            font-weight: bold;
        }
        input, button, select {
            width: 100%;
            margin-bottom: 10px;
            padding: 10px;
        }
        .btn {
            background-color: #00bfff; /* Azul celeste */
            color: white;
            border: none;
            cursor: pointer;
        }
        .btn:hover {
            background-color: #009acd;
        }
        .output {
            white-space: pre-wrap;
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 5px;
        }
        .record-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ccc;
            margin-top: 20px;
            padding: 10px;
        }
        .logo {
            display: block;
            margin: 0 auto;
            width: 100px;
            height: 96px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Registro de Internos del Día</h2>
        <label for="centroInternamiento">Centro de Internamiento:</label>
        <input type="text" id="centroInternamiento" value="DIRECCIÓN DE MEDIDAS DE EJECUCIÓN PARA ADOLESCENTES">

        <label for="fecha">Fecha:</label>
        <input type="date" id="fecha">
        
        <label for="hora">Hora:</label>
        <input type="time" id="hora">
        
        <label for="motivo">Motivo:</label>
        <input type="text" id="motivo">
        
        <label for="excarceladosH">Excarcelados (H):</label>
        <input type="number" id="excarceladosH">
        
        <label for="excarceladosM">Excarcelados (M):</label>
        <input type="number" id="excarceladosM">
        
        <label for="presentesH">Presentes (H):</label>
        <input type="number" id="presentesH">
        
        <label for="presentesM">Presentes (M):</label>
        <input type="number" id="presentesM">
        
        <label for="total">Total:</label>
        <input type="number" id="total">
        
        <label for="custodioResponsable">Custodio Responsable:</label>
        <input type="text" id="custodioResponsable">
        
        <label for="personalDGRS">Personal D.G.R.S.:</label>
        <input type="text" id="personalDGRS">
        
        <button class="btn" onclick="exportarPDF()">Generar PDF</button>
        <button class="btn" onclick="exportarPDFCompleto()">Generar PDF Completo</button>
        <button class="btn" onclick="cerrarSesion()">Cerrar sesión</button>
    </div>

    <script>
        function exportarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('landscape'); // Hoja horizontal

            const logo = new Image();
            logo.src = 'logo_sspc2.png'; // Ruta al logo

            const fecha = document.getElementById('fecha').value;
            const hora = document.getElementById('hora').value;
            const motivo = document.getElementById('motivo').value;
            const excarceladosH = document.getElementById('excarceladosH').value;
            const excarceladosM = document.getElementById('excarceladosM').value;
            const presentesH = document.getElementById('presentesH').value;
            const presentesM = document.getElementById('presentesM').value;
            const total = document.getElementById('total').value;
            const custodioResponsable = document.getElementById('custodioResponsable').value;
            const personalDGRS = document.getElementById('personalDGRS').value;
            const centroInternamiento = document.getElementById('centroInternamiento').value;
            
            // Agregar logo
            logo.onload = () => {
                doc.addImage(logo, 'PNG', 10, 10, 30, 28); // Ajusta la posición y tamaño

                // Título del Centro de Internamiento
                doc.setFontSize(16);
                doc.text(centroInternamiento, 105, 20, null, null, 'center');

                // Título del Registro
                doc.setFontSize(18);
                doc.text('Registro Completo', 105, 40, null, null, 'center');
                doc.setFontSize(12);
                doc.text('Fecha: ' + fecha + ' - Hora: ' + hora, 105, 50, null, null, 'center');

                // Tabla de datos
                const headers = ['Fecha', 'Hora', 'Motivo', 'Excarcelados (H)', 'Excarcelados (M)', 'Presentes (H)', 'Presentes (M)', 'Total', 'Custodio Responsable', 'Personal D.G.R.S.'];
                const data = [[fecha, hora, motivo, excarceladosH, excarceladosM, presentesH, presentesM, total, custodioResponsable, personalDGRS]];

                doc.autoTable({
                    head: [headers],
                    body: data,
                    startY: 60,
                    theme: 'grid'
                });

                doc.save('registro_internos.pdf');
            };
        }

        function exportarPDFCompleto() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('landscape'); // Hoja horizontal

            const logo = new Image();
            logo.src = 'logo_sspc2.png'; // Ruta al logo

            // Registros completos
            let registrosPorFecha = JSON.parse(localStorage.getItem('registrosPorFecha')) || {};
            let registros = Object.values(registrosPorFecha).flat();
            const centroInternamiento = document.getElementById('centroInternamiento').value;
            const headers = ['Fecha', 'Hora', 'Motivo', 'Excarcelados (H)', 'Excarcelados (M)', 'Presentes (H)', 'Presentes (M)', 'Total', 'Custodio Responsable', 'Personal D.G.R.S.'];
            const data = registros.map(registro => [
                registro.fecha, registro.hora, registro.motivo,
                registro.excarceladosH, registro.excarceladosM,
                registro.presentesH, registro.presentesM,
                registro.total, registro.custodioResponsable,
                registro.personalDGRS
            ]);

            // Agregar logo
            logo.onload = () => {
                doc.addImage(logo, 'PNG', 10, 10, 30, 28); // Ajusta la posición y tamaño

                // Título del Centro de Internamiento
                doc.setFontSize(16);
                doc.text(centroInternamiento, 105, 20, null, null, 'center');

                // Título del Registro Completo
                doc.setFontSize(18);
                doc.text('Registro Completo', 105, 40, null, null, 'center');
                doc.setFontSize(12);
                doc.text('Fecha: ' + new Date().toLocaleDateString(), 105, 50, null, null, 'center');

                // Tabla de registros
                doc.autoTable({
                    head: [headers],
                    body: data,
                    startY: 60,
                    theme: 'grid'
                });

                doc.save('registro_internos_completo.pdf');
            };
        }

        function cerrarSesion() {
            localStorage.removeItem('loggedIn');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>
